"use strict";angular.module("opendoorApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("opendoorApp").controller("MainCtrl",["$scope","$timeout","$location","WordService","ScrambleService","KeyBinderService","FirebaseService",function(a,b,c,d,e,f,g){a.word={word:[],definition:"Start to find out!"},a.scrambled=[],a.answer=[],a.winner="",a.time=120,a.player={score:0,name:""},a.gameOver=!1,a.timer=function(){b(function(){a.time>0?(a.time--,a.timer()):a.loseGame()},1e3)},a.getWord=function(){d.get().success(function(b){a.answer=[],a.winner="",a.word.word=b.word.toUpperCase().replace(/\W+/g,"").split(""),a.scrambled=e(angular.copy(a.word.word))}).error(function(a){console.log(a)})},a.init=function(){a.timer(),a.getWord()},a.init(),a.addLetter=function(b){if(a.scrambled.indexOf(b)>=0){a.answer.push(b);var c=a.scrambled.indexOf(b);a.scrambled.splice(c,1),a.answer.length==a.word.word.length&&a.check()}},a.check=function(){var b=a.answer.join("");d.check(b).success(function(b){console.log(b),b.length?(a.winner="win",a.win(),console.log(b[0].text),a.word.definition=b[0].text):(a.winner="lose",a.lose())}).error(function(a){console.log(a)})},a.win=function(){a.player.score+=a.word.word.length,a.getWord()},a.lose=function(){b(function(){a.scrambled=a.answer,a.answer=[]},1e3),a.player.score--},a.loseGame=function(){a.gameOver=!0},a.saveScore=function(b){g.create(b),a.player={name:"",score:0},g.read().on("value",function(b){a.topscores=[],b.forEach(function(b){a.topscores.push({name:b.val().name,score:b.val().score})}),a.$apply(),console.log(a.topscores)})},a.skip=function(){a.player.score--,a.getWord()},a.shuffle=function(){a.answer=[],a.scrambled=e(angular.copy(a.word.word))},a.reset=function(){c.path("/x")},a.$on("keyPressed",function(b,c){var d=String.fromCharCode(c);console.log(d,c),a.addLetter(d),a.$apply()})}]),angular.module("opendoorApp").directive("letterPanel",[function(){return{template:'<div class="letterPanel" ng-class=info ng-model="letter">{{letter}}</div>',restrict:"E"}}]),angular.module("opendoorApp").service("WordService",["$http",function(a){var b="http://api.wordnik.com:80/v4/words.json/randomWord?hasDictionaryDef=true&includePartOfSpeech=noun&excludePartOfSpeech=proper-noun&minCorpusCount=15000&maxCorpusCount=-1&minDictionaryCount=1&maxDictionaryCount=-1&minLength=4&maxLength=6&api_key=a2a73e7b926c924fad7001ca3111acd55af2ffabf50eb4ae5",c=function(){return a.get(b)},d="http://api.wordnik.com:80/v4/word.json/",e="/definitions?limit=1&includeRelated=true&useCanonical=false&includeTags=false&api_key=a2a73e7b926c924fad7001ca3111acd55af2ffabf50eb4ae5",f=function(b){return b=b.toLowerCase(),a.get(d+b+e)};return{get:c,check:f}}]),angular.module("opendoorApp").service("ScrambleService",[function(){var a=function(a){var b,c,d=a.length;for(console.log(a);d>0;)c=Math.floor(Math.random()*d),d--,b=a[d],a[d]=a[c],a[c]=b;return console.log(a),a};return a}]),angular.module("opendoorApp").service("KeyBinderService",["$document","$rootScope",function(a,b){function c(a){console.log(a),d=a.keyCode,b.$broadcast("keyPressed",d)}var d;a.on("keyup",c)}]),angular.module("opendoorApp").service("FirebaseService",["$http",function(){var a=new Firebase("https://opendoorwordgame.firebaseio.com/"),b=new Firebase("https://opendoorwordgame.firebaseio.com/scores"),c=function(b){a.child("scores").push({name:b.name,score:b.score})},d=function(){return b.orderByChild("score").limitToLast(5)};return{create:c,read:d}}]);